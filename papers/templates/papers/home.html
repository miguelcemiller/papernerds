{% extends 'main.html' %}


{% block content %}


<section class="cards">
   
    {% for paper in papers %}
    <div class="paper_card">
        <div class="paper_details">
            <div class="paper_title" value="{{ paper.title }}" search="{{ search }}">{{ paper.title }}</div>
            <div class="subtitle_container">
                <div class="paper_views">{{ paper.downloads }} views</div>
                <div class="paper_author">Author1, Author2, Author 3 {{ paper.year }}</div>
            </div>
            <div class="paper_abstract" class="abstract" value="{{ paper.abstract }}" search="{{ search }}">
                {{ paper.abstract|slice:":240"}}...
            </div>  
        </div>
    </div>
    {% endfor %}
</section>

<div class="pagination">
    <ul class="pagination_nav">
        <li><a href="#" class="active">1</a></li>
        <li><a href="#">2</a></li>
        <li><a href="#">3</a></li>
    </ul>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

<script type="text/javascript">
    
    // const highlight = (needle, haystack) =>
    //     haystack.replace(
    //         new RegExp(needle, 'gi'),
    //         (str) => `<b>${str}</b>`
    //     );

    const highlight = (needle, haystack) =>
        haystack.replace(
            new RegExp(`(${needle.join('|')})`, 'gi'),
            (str) => `<b>${str}</b>`
        );

     // Paper title abstract highlight 

    $(".paper_abstract").each(function (index, element) {

        var abstract = $(element).attr('value');
        var search = $(element).attr('search');


        var searchArr = search.split(/\s/);

        $(element).html(highlight(searchArr, abstract)); 
    }); 

    // Paper title search highlight 

    $(".paper_title").each(function (index, element) {

        var title = $(element).attr('value');
        var search = $(element).attr('search');


        var searchArr = search.split(/\s/);

        $(element).html(highlight(searchArr, title)); 
    }); 

    

</script>


{% endblock content %}